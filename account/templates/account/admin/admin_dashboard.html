{% include "store/base.html" %} {% include "store/modal.html" %} {% load static %} {% load crispy_forms_tags %}
{% block content %}
<link rel="stylesheet" href="{% static 'css/modal.css' %}" />
<link rel="stylesheet" href="{% static 'css/layout.css' %}" />

<body>
  <br />
  <div class="container bg-white shadow-md p-5 form-layout">
    <h4>
      <i class="fa fa-hand-paper-o" aria-hidden="true"></i> &nbsp; Admin Panel
    </h4>
    <hr />
    <p>
      Hello, {{ user.username }}! From this panel you can manage users and
      permissions.
    </p>
  </div>

  <div class="container bg-white shadow-md p-5 form-layout w-100">
    <h4>
      <i class="fa fa-users" aria-hidden="true"></i> &nbsp; Management users
    </h4>
    <hr />
    <table class="table table-striped">
      <thead>
        <tr>
          <th>Username</th>
          <th>Email</th>
          <th>Uprawnienia</th>
          <th>Akcje</th>
        </tr>
      </thead>
      <tbody>
        {% for u in users %}
        <tr>
          <td>{{ u.username }}</td>
          <td>{{ u.email }}</td>
          <td>
            {% if u.is_staff %} Administrator {% else %} UÅ¼ytkownik {% endif %}
          </td>
          <td>
            <button
              class="btn btn-danger delete-button"
              data-username="{{ u.username }}"
              data-userid="{{ u.id }}"
              {% if user.username == u.username %} disabled {% endif %}
            >
              Delete
            </button>
            {% if u.is_superuser %}
                <button
                  class="btn btn-info set-admin-user-button"
                  data-username="{{ u.username }}"
                  data-userid="{{ u.id }}"
                  data-operation="change_permissions"
                  data-message="Are you sure you want to <strong>revoke the administrator privileges</strong> of the user {{ u.username }}?"
                  {% if user.username == u.username %} disabled {% endif %}
                  onclick="openModal(this)"
                >
                  Set admin as user
                </button>
              {% else %}
                <button
                  class="btn btn-info set-user-admin-button"
                  data-username="{{ u.username }}"
                  data-userid="{{ u.id }}"
                  data-operation="change_permissions"
                  data-message="Are you sure you want to <strong>grant administrator privileges</strong> to the user {{ u.username }}?"
                  {% if user.username == u.username %} disabled {% endif %}
                  onclick="openModal(this)"
                >
                  Set user as admin
                </button>
              {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</body><script src="{% static 'js/modal.js' %}"></script>
{% endblock %}
